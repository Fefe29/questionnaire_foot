<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Déplacements et véhicules foot Arradon</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #b20000; /* Fond rouge foncé */
            position: relative;
        }

        h1 {
            text-align: center;
            color: #fff; /* Texte blanc pour contraster avec le fond rouge */
            text-transform: uppercase; /* Majuscules pour le titre */
        }

        /* Style pour le logo centré */
        .logo-centered {
            display: block;
            margin: 0 auto 20px auto; /* Centré avec un margin */
            width: 120px; /* Taille du logo */
            z-index: 1; /* Logo au premier plan */
        }

        form {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            margin: auto;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }

        input, select, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        /* Fond blanc pour le tableau */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: white; /* Fond blanc du tableau */
            position: relative;
            z-index: 1;
        }

        table, th, td {
            border: 1px solid #ccc;
        }

        th, td {
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #333;
            color: white;
        }

        tfoot td {
            font-weight: bold;
        }

        .green {
            color: green;
        }

        .orange {
            color: orange;
        }

        .legend {
            margin-top: 20px;
            font-size: 14px;
            position: relative;
            z-index: 1;
        }

        .legend span {
            font-weight: bold;
        }

        /* Style pour le bouton effacer les données en petit tout en bas */
        .clear-data-section {
            text-align: center;
            margin-top: 40px;
            font-size: 12px;
            color: #fff;
        }

        .clear-data-section button {
            font-size: 10px;
            padding: 5px 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .clear-data-section p {
            margin-top: 10px;
            font-size: 10px;
            color: #ffcccc;
        }
    </style>
</head>
<body>

    <h1>Déplacements et véhicules foot Arradon</h1>
    <img src="logo.png" alt="Logo" class="logo-centered">

    <form id="transportForm">
        <label for="childName">Nom de l'enfant :</label>
        <input type="text" id="childName" name="childName" required>

        <label for="date">Date du déplacement :</label>
        <input type="date" id="date" name="date" required>

        <label for="transportOption">Disponibilités des parents :</label>
        <select id="transportOption" name="transportOption" required>
            <option value="allerRetour">Transport aller/retour</option>
            <option value="aller">Seulement l'aller</option>
            <option value="retour">Seulement le retour</option>
            <option value="aucun">Aucun</option>
        </select>

        <div id="optionalChoices">
            <label><input type="checkbox" id="sureCheckbox"> Je suis sûr d'y aller</label>
            <label><input type="checkbox" id="ifNeededCheckbox"> Je peux venir si besoin</label>
        </div>

        <label for="carSeats">Nombre de places disponibles (y compris l'enfant) :</label>
        <input type="number" id="carSeats" name="carSeats" min="1" required>

        <button type="submit">Soumettre</button>
    </form>

    <h2>Déplacements</h2>
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Noms des enfants</th>
                <th>Nombre de places à l'aller</th>
                <th>Nombre de places au retour</th>
            </tr>
        </thead>
        <tbody id="eventTable">
            <!-- Les informations seront ajoutées ici -->
        </tbody>
    </table>

    <div class="legend">
        <p>Légende des couleurs :</p>
        <p><span class="green">Vert</span> : Les parents sont sûrs d'y aller.</p>
        <p><span class="orange">Orange</span> : Les parents peuvent venir si besoin.</p>
    </div>

    <!-- Section en bas de la page pour effacer les données -->
    <div class="clear-data-section">
        <button id="clearDataButton">Effacer les données</button>
        <p>Attention suppression définitive réservée au gestionnaire</p>
    </div>

    <script>
        const form = document.getElementById('transportForm');
        const eventTable = document.getElementById('eventTable');
        const transportOption = document.getElementById('transportOption');
        const optionalChoices = document.getElementById('optionalChoices');
        const sureCheckbox = document.getElementById('sureCheckbox');
        const ifNeededCheckbox = document.getElementById('ifNeededCheckbox');
        
        let eventData = JSON.parse(localStorage.getItem('eventData')) || {}; // Charger les données sauvegardées

        // Afficher les données sauvegardées au démarrage
        window.addEventListener('load', function() {
            if (eventData) {
                updateEventTable();
            }
        });

        // Afficher les cases par défaut, mais les supprimer si "Aucun" est sélectionné
        transportOption.addEventListener('change', function() {
            if (transportOption.value === 'aucun') {
                optionalChoices.style.display = 'none';
                sureCheckbox.checked = false;
                ifNeededCheckbox.checked = false;
            } else {
                optionalChoices.style.display = 'block';
            }
        });

        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Prévenir le rechargement de la page

            const childName = document.getElementById('childName').value;
            const date = document.getElementById('date').value;
            const carSeats = parseInt(document.getElementById('carSeats').value);

            let placesAller = 0;
            let placesRetour = 0;

            if (transportOption.value === 'allerRetour') {
                placesAller = carSeats;
                placesRetour = carSeats;
            } else if (transportOption.value === 'aller') {
                placesAller = carSeats;
                placesRetour = 0;  // Pas de places au retour
            } else if (transportOption.value === 'retour') {
                placesRetour = carSeats;
                placesAller = 0;  // Pas de places à l'aller
            }

            let className = '';
            if (sureCheckbox.checked) {
                className = 'green';
            } else if (ifNeededCheckbox.checked) {
                className = 'orange';
            }

            if (transportOption.value !== 'aucun' && !className) {
                alert('Veuillez sélectionner une option supplémentaire.');
                return;
            }

            if (!eventData[date]) {
                eventData[date] = {
                    children: [],
                    totalSeatsAller: 0,
                    totalSeatsRetour: 0
                };
            }

            eventData[date].children.push({
                name: childName, 
                seatsAller: placesAller, 
                seatsRetour: placesRetour, 
                className: className
            });

            eventData[date].totalSeatsAller += placesAller;
            eventData[date].totalSeatsRetour += placesRetour;

            // Sauvegarder les données dans localStorage
            localStorage.setItem('eventData', JSON.stringify(eventData));

            updateEventTable();
            form.reset();
            optionalChoices.style.display = 'block';  // Réafficher les cases après soumission
        });

        function updateEventTable() {
            eventTable.innerHTML = '';
            for (const date in eventData) {
                const childrenList = eventData[date].children.map((child, index) => `
                    <span class="${child.className}">${child.name}</span> (${child.seatsAller} places à l'aller, ${child.seatsRetour} places au retour)
                    <button onclick="deleteEntry('${date}', ${index})">Supprimer</button>
                `).join(', ');

                const totalSeatsAller = eventData[date].totalSeatsAller;
                const totalSeatsRetour = eventData[date].totalSeatsRetour;

                const row = `
                    <tr>
                        <td>${date}</td>
                        <td>${childrenList}</td>
                        <td>${totalSeatsAller}</td>
                        <td>${totalSeatsRetour}</td>
                    </tr>
                    <tr>
                        <td colspan="2"><strong>Total pour cette date :</strong></td>
                        <td><strong>${totalSeatsAller}</strong></td>
                        <td><strong>${totalSeatsRetour}</strong></td>
                    </tr>
                `;
                eventTable.innerHTML += row;
            }
        }

        function deleteEntry(date, index) {
            if (confirm("Êtes-vous sûr de vouloir supprimer cette entrée ?")) {
                eventData[date].children.splice(index, 1); // Supprimer l'enfant de la liste

                if (eventData[date].children.length === 0) {
                    delete eventData[date]; // Supprimer l'entrée complète si elle est vide
                }

                localStorage.setItem('eventData', JSON.stringify(eventData)); // Mettre à jour localStorage
                updateEventTable(); // Mettre à jour le tableau
            }
        }

        document.getElementById('clearDataButton').addEventListener('click', function() {
            if (confirm("Êtes-vous sûr de vouloir effacer toutes les données ?")) {
                localStorage.removeItem('eventData'); // Effacer les données sauvegardées
                eventData = {}; // Réinitialiser l'objet en mémoire
                updateEventTable(); // Mettre à jour le tableau pour l'afficher vide
            }
        });
    </script>

</body>
</html>
